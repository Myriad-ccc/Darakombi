<Window
    x:Class="Darakombi.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Darakombi"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="Darakombi"
    Width="1024"
    Height="868"
    Background="#0F0F0F"
    FontFamily="VCR OSD Mono"
    Foreground="White"
    Icon="Assets/Icon.ico"
    IsTabStop="False"
    KeyDown="Window_KeyDown"
    KeyUp="Window_KeyUp"
    PreviewKeyDown="Window_PreviewKeyDown"
    ResizeMode="NoResize"
    SnapsToDevicePixels="True"
    UseLayoutRounding="True"
    WindowStartupLocation="CenterScreen"
    WindowStyle="None"
    mc:Ignorable="d">

    <Window.Resources>

        <SolidColorBrush x:Key="CoolRed" Color="#b3251b" />
        <SolidColorBrush x:Key="CoolDarkRed" Color="#701611" />
        <SolidColorBrush x:Key="CoolGreen" Color="#44B73E" />

        <Style x:Key="MenuButtonStyle" TargetType="Button">
            <Setter Property="Tag" Value="#000000" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="{Binding RelativeSource={RelativeSource Self}, Path=Tag}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            x:Name="ButtonBorder"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="ButtonBorder" Property="Background" Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Tag}" />
                                <Setter Property="Foreground" Value="White" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="48" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid
            x:Name="TitleBar"
            Grid.Row="0"
            Background="#323232"
            MouseDown="TitleBar_MouseDown"
            MouseMove="TitleBar_MouseMove"
            MouseUp="TitleBar_MouseUp">
            <TextBlock
                x:Name="TitleTextShadow"
                Padding="5,5,0,0"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                FontSize="40"
                Text="{Binding Title, RelativeSource={RelativeSource AncestorType=Window}}" />
            <StackPanel Orientation="Horizontal">
                <TextBlock
                    x:Name="TitleText"
                    Padding="6,6,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    FontSize="40"
                    Text="{Binding Title, RelativeSource={RelativeSource AncestorType=Window}}" />

                <TextBlock
                    x:Name="RuntimeDebugText"
                    Padding="20,0,0,0"
                    VerticalAlignment="Center"
                    FontSize="32"
                    Foreground="White" />

                <TextBlock
                    x:Name="TopKeys"
                    Padding="20,0,0,0"
                    VerticalAlignment="Center"
                    FontSize="20"
                    Foreground="Aqua" />

                <TextBlock
                    x:Name="MapSizeText"
                    Padding="20,0,0,0"
                    VerticalAlignment="Center"
                    FontSize="20"
                    Foreground="MediumPurple" />
            </StackPanel>

            <StackPanel
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                Orientation="Horizontal">

                <Button
                    x:Name="DebugMenuButton"
                    Width="64"
                    Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=Grid}}"
                    Click="DebugMenuButton_Click"
                    Content="⚙"
                    FontSize="32"
                    Style="{StaticResource MenuButtonStyle}"
                    Tag="{StaticResource CoolGreen}" />

                <Button
                    x:Name="ConsoleButton"
                    Width="64"
                    Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=Grid}}"
                    Click="ConsoleButton_Click"
                    Content="&lt;/&gt;"
                    FontSize="32"
                    Style="{StaticResource MenuButtonStyle}"
                    Tag="#0696EF" />

                <Button
                    x:Name="EscapeMenuButton"
                    Width="64"
                    Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=Grid}}"
                    Click="EscapeMenuButton_Click"
                    Content="☰"
                    FontSize="42"
                    Style="{StaticResource MenuButtonStyle}"
                    Tag="#4CDAE4" />

                <Button
                    x:Name="ClosingButton"
                    Width="64"
                    Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=Grid}}"
                    Background="Transparent"
                    BorderThickness="0"
                    Click="ClosingButton_Click"
                    Content="✖"
                    FontSize="30"
                    Style="{StaticResource MenuButtonStyle}"
                    Tag="{StaticResource CoolRed}" />

            </StackPanel>
        </Grid>

        <Grid
            x:Name="MainMenu"
            Grid.Row="1"
            ClipToBounds="True"
            SnapsToDevicePixels="True">

            <Canvas
                x:Name="GameCanvas"
                Background="Transparent"
                MouseDown="GameCanvas_MouseDown"
                MouseMove="GameCanvas_MouseMove"
                MouseUp="GameCanvas_MouseUp"
                MouseWheel="GameCanvas_MouseWheel"
                Visibility="Hidden">

                <Canvas x:Name="WorldCanvas">
                    <Canvas.RenderTransform>
                        <TransformGroup>
                            <ScaleTransform x:Name="CameraScale" ScaleX="1" ScaleY="1" />
                            <SkewTransform x:Name="CameraSkew" AngleX="0" AngleY="0" />
                            <RotateTransform x:Name="CameraRotate" CenterX="0" CenterY="0" />
                            <TranslateTransform x:Name="CameraTransform" X="0" Y="0" />
                        </TransformGroup>
                    </Canvas.RenderTransform>
                </Canvas>

            </Canvas>

            <Grid x:Name="StartMenu" Visibility="Visible">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">

                    <Button
                        x:Name="PlayButton"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="PlayButton_Click"
                        Content="Play"
                        FontSize="84"
                        Foreground="White">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <ContentPresenter />
                            </ControlTemplate>
                        </Button.Template>
                    </Button>

                    <Button
                        x:Name="EditorButton"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="EditorButton_Click"
                        Content="Editor"
                        FontSize="84"
                        Foreground="White">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <ContentPresenter />
                            </ControlTemplate>
                        </Button.Template>
                    </Button>

                    <Button
                        x:Name="MapButton"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="MapButton_Click"
                        Content="Map"
                        FontSize="84"
                        Foreground="LightPink">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <ContentPresenter />
                            </ControlTemplate>
                        </Button.Template>
                    </Button>

                    <Button
                        x:Name="ChooseButton"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="ChooseButton_Click"
                        Content="Choose"
                        FontSize="84"
                        Foreground="White">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <ContentPresenter />
                            </ControlTemplate>
                        </Button.Template>
                    </Button>

                </StackPanel>
            </Grid>

            <Grid
                x:Name="EscapeMenu"
                Background="#800F0F0F"
                Visibility="Hidden">
                <StackPanel
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Orientation="Vertical">
                    <Button
                        x:Name="ResumeButton"
                        Click="EscapeMenuButton_Click"
                        Content="Resume"
                        FontSize="54"
                        Style="{StaticResource MenuButtonStyle}"
                        Tag="{StaticResource CoolRed}" />

                    <Button
                        x:Name="OptionsButton"
                        Click="OptionsButton_Click"
                        Content="Options"
                        FontSize="54"
                        Style="{StaticResource MenuButtonStyle}" />
                    <Button
                        x:Name="ExitButton"
                        Click="ExitButton_Click"
                        Content="Exit"
                        FontSize="54"
                        Style="{StaticResource MenuButtonStyle}"
                        Tag="{StaticResource CoolRed}" />
                </StackPanel>
            </Grid>

            <Grid
                x:Name="DebugMenu"
                MaxHeight="550"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Background="#CC0F0F0F"
                Visibility="Hidden">
                <ScrollViewer HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Hidden">
                    <StackPanel Orientation="Vertical">
                        <TextBlock
                            FontSize="44"
                            Foreground="MediumPurple"
                            Text="QuickDisplay" />
                        <StackPanel x:Name="DebugCategoryTabs" Orientation="Horizontal" />
                    </StackPanel>
                </ScrollViewer>
            </Grid>

            <Border
                x:Name="ConsoleMenu"
                Background="#66232323"
                BorderBrush="#000000"
                BorderThickness="5"
                IsHitTestVisible="True"
                Visibility="Collapsed">

                <Grid Margin="5">

                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="40" />
                    </Grid.RowDefinitions>

                    <RichTextBox
                        x:Name="ConsoleLogs"
                        Grid.Row="0"
                        Background="Transparent"
                        BorderThickness="0"
                        FontSize="30"
                        Foreground="White"
                        IsReadOnly="True"
                        VerticalScrollBarVisibility="Hidden">
                        <FlowDocument PagePadding="0" />
                    </RichTextBox>

                    <TextBox
                        x:Name="CommandPredictive"
                        Grid.Row="1"
                        HorizontalContentAlignment="Left"
                        VerticalContentAlignment="Center"
                        Background="#803C3C3C"
                        BorderThickness="0"
                        FontSize="36"
                        Foreground="Gray" />

                    <TextBox
                        x:Name="CommandLine"
                        Grid.Row="1"
                        HorizontalContentAlignment="Left"
                        VerticalContentAlignment="Center"
                        Background="#803C3C3C"
                        BorderThickness="0"
                        FontSize="36"
                        Foreground="White"
                        KeyDown="CommandLine_KeyDown"
                        TextChanged="CommandLine_TextChanged"/>
                </Grid>

            </Border>

            <Grid x:Name="MapMenu" Visibility="Hidden">
                <Grid.RowDefinitions>
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="230" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="230" />
                </Grid.ColumnDefinitions>

                <TextBlock
                    Grid.Row="0"
                    Grid.Column="1"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    FontSize="82"
                    Text="Set map size" />

                <StackPanel
                    Grid.Row="1"
                    Grid.Column="1"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Orientation="Vertical">
                    <TextBlock FontSize="64" Text="Width:" />
                    <TextBox
                        x:Name="MapWidthContent"
                        HorizontalAlignment="Center"
                        Background="Transparent"
                        BorderThickness="0"
                        FontSize="60"
                        Foreground="White"
                        TextChanged="MapWidthContent_TextChanged" />
                </StackPanel>
                <StackPanel
                    Grid.Row="1"
                    Grid.Column="1"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Orientation="Vertical">
                    <TextBlock FontSize="64" Text="Height:" />
                    <TextBox
                        x:Name="MapHeightContent"
                        HorizontalAlignment="Center"
                        Background="Transparent"
                        BorderThickness="0"
                        FontSize="60"
                        Foreground="White"
                        TextChanged="MapHeightContent_TextChanged" />
                </StackPanel>
                <StackPanel
                    Grid.Row="1"
                    Grid.Column="1"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Bottom"
                    Orientation="Vertical">
                    <Button
                        x:Name="ResetMapDimensions"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="ResetMapDimensions_Click"
                        Content="Reset"
                        FontSize="54"
                        Foreground="Orange" />
                    <Button
                        x:Name="SetMapSizeButton"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="SetMapSizeButton_Click"
                        Content="Set"
                        FontSize="54"
                        Foreground="LightGreen" />
                </StackPanel>
            </Grid>

            <Grid x:Name="EditorHUD" Visibility="Collapsed">

                <Grid
                    x:Name="EditorQuitWarning"
                    Background="#80000000"
                    Visibility="Hidden">

                    <Border
                        Width="Auto"
                        Padding="24"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="#181818"
                        CornerRadius="10">

                        <StackPanel>
                            <TextBlock
                                Margin="0,0,0,12"
                                FontSize="50"
                                FontWeight="SemiBold"
                                Foreground="White"
                                Text="Unsaved 1changes"
                                TextAlignment="Center" />

                            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                <Button
                                    x:Name="EditorDiscardButton"
                                    MinWidth="90"
                                    Margin="0,0,8,0"
                                    Background="Gray"
                                    BorderThickness="0"
                                    Click="EditorDiscardButton_Click"
                                    Content="Discard"
                                    FontSize="36"
                                    Foreground="White" />

                                <Button
                                    MinWidth="90"
                                    BorderThickness="0"
                                    Click="EditorSave_Click"
                                    Content="Save"
                                    FontSize="36"
                                    Foreground="White"
                                    Style="{StaticResource MenuButtonStyle}"
                                    Tag="#B5338A" />
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </Grid>

                <Button
                    x:Name="EditorSave"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    BorderThickness="0"
                    Click="EditorSave_Click"
                    Content="Save"
                    FontSize="50"
                    Style="{StaticResource MenuButtonStyle}"
                    Tag="#b5338A" />

                <Button
                    x:Name="EntityPicker"
                    Margin="0,49,5,0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    BorderThickness="0"
                    Click="EntityPicker_Click"
                    Content="Picker"
                    FontSize="50"
                    Style="{StaticResource MenuButtonStyle}"
                    Tag="{StaticResource CoolRed}">
                    <Button.RenderTransformOrigin>0.5,0.5</Button.RenderTransformOrigin>
                    <Button.LayoutTransform>
                        <RotateTransform Angle="270" />
                    </Button.LayoutTransform>
                </Button>


                <StackPanel
                    x:Name="EditorColorSliders"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Bottom"
                    Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock
                            FontSize="32"
                            Foreground="IndianRed"
                            Text="Red" />

                        <StackPanel Orientation="Horizontal">
                            <Slider
                                x:Name="RedSlider"
                                Width="100"
                                Height="20"
                                Maximum="255"
                                Minimum="0"
                                SmallChange="1"
                                Value="255" />

                            <TextBlock
                                x:Name="RedSliderText"
                                Margin="8,0,0,0"
                                FontSize="32"
                                Text="{Binding ElementName=RedSlider, Path=Value, StringFormat=N0}" />
                        </StackPanel>
                    </StackPanel>

                    <StackPanel>
                        <TextBlock
                            FontSize="32"
                            Foreground="LightGreen"
                            Text="Green" />

                        <StackPanel Orientation="Horizontal">
                            <Slider
                                x:Name="GreenSlider"
                                Width="100"
                                Height="20"
                                Maximum="255"
                                Minimum="0"
                                SmallChange="1"
                                Value="255" />

                            <TextBlock
                                x:Name="GreenSliderText"
                                Margin="8,0,0,0"
                                FontSize="32"
                                Text="{Binding ElementName=GreenSlider, Path=Value, StringFormat=N0}" />
                        </StackPanel>
                    </StackPanel>

                    <StackPanel>
                        <TextBlock
                            FontSize="32"
                            Foreground="SkyBlue"
                            Text="Blue" />

                        <StackPanel Orientation="Horizontal">
                            <Slider
                                x:Name="BlueSlider"
                                Width="100"
                                Height="20"
                                Maximum="255"
                                Minimum="0"
                                SmallChange="1"
                                Value="255" />

                            <TextBlock
                                x:Name="BlueSliderText"
                                Margin="8,0,0,0"
                                FontSize="32"
                                Text="{Binding ElementName=BlueSlider, Path=Value, StringFormat=N0}" />
                        </StackPanel>
                    </StackPanel>
                </StackPanel>

            </Grid>

            <StackPanel
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Orientation="Vertical">
                <TextBlock
                    x:Name="DebugText"
                    FontSize="32"
                    Foreground="White" />
            </StackPanel>
        </Grid>
    </Grid>
</Window>